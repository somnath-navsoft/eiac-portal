<app-loader *ngIf="!loader"></app-loader>
<div class="main-detail">
    <div class="container-fluid p-0">
        <div class="main-dashboard">
            <div class="row">
                <div class="col-md-6">
                    <div class="trainer-details" >
                        <div class="trainer-name">
                            <h4>{{userDetails?.first_name}} {{userDetails?.last_name}}</h4>
                            <div class="acc_verified">
                                <span class="icon-check-circle"></span>
                                <span class="tooltip_data">Account Verified</span>
                            </div>
                        </div>
                        <div class="trainer-detail" [ngStyle]="{'display':'block'}">
                            <span class="trainer-data"  [ngStyle]="{'padding-right':'45px'}"><span class="icon-company"></span>{{step1Data?.office}}</span>
                            <span class="trainer-data"  [ngStyle]="{'padding-right':'45px'}"><span class="icon-email"></span>{{userDetails?.email}}</span>
                            <span class="trainer-data"><span class="icon-call"></span>{{userDetails?.contact}}</span>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="trainer-content">
                        <div class="trainer-type">
                            <span>Type</span>
                        </div>
                        <div class="trainer-type-data">
                            <span>{{step1Data.designation}}</span>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="trainer-content">
                        <div class="trainer-type">
                            <span>Technical Fields</span>
                        </div>
                        <div class="trainer-type-data">
                            <span>{{step2Data?.specialization}}<span class="icon-checkmark"></span></span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-3">
                    <a routerLink="/dashboard/{{userType}}/company-profile">
                    <div class="trainer-main-details">
                        <div class="user-icons">
                            <span class="icon-user"></span>
                        </div>
                        <div class="trainer-data-det">
                            <div class="trainer-pro">
                                <span>Profile</span>
                            </div>
                            <div class="trainer-maindata trainer-update">
                                <span>Update
                                    
                                        <span [ngStyle]="{'color': '#FFF', 'font-size':'31px'}">></span>
                                        <!-- <span class="icon-right-arrow"></span> -->
                                    
                                </span>
                                <!-- <span>Update<span class="icon-right-arrow"></span></span> -->
                            </div>
                        </div>
                    </div>
                    </a>
                </div>
                <div class="col-md-3">
                    <a href="javascript:void(0)" routerLink="/dashboard/event-list">
                    <div class="trainer-main-details trainer2">
                        <div class="user-icons">
                            <span class="icon-calendar"></span>
                        </div>
                        <div class="trainer-data-det">
                            <div class="trainer-pro">
                                <span>Events</span>
                            </div>
                            <div class="trainer-maindata">
                                <span>{{dashboardItemData.eventCount}}</span>
                            </div>
                        </div>
                    </div>
                    </a>
                </div>
                <div class="col-md-3">
                    <a routerLink="/dashboard/{{userType}}/company-profile">
                    <div class="trainer-main-details trainer3">
                        <div class="user-icons">
                            <span class="icon-tick"></span>
                        </div>
                        <div class="trainer-data-det">
                            <div class="trainer-pro">
                                <span>Technical Fields</span>
                            </div>
                            <div class="trainer-maindata">
                                <span>{{technicalFieldsCount}}</span>
                            </div>
                        </div>
                    </div>
                    </a>
                </div>
                <div class="col-md-3">
                    <div class="trainer-main-details trainer4">
                        <div class="user-icons">
                            <span class="icon-options"></span>
                        </div>
                        <div class="trainer-data-det"
                            [ngStyle]="{'width': '50%', 'border-right': '1px solid','border-right-color': '#FFF' }"> 
                            <div class="trainer-pro">
                                <span>Date Appointed</span>
                            </div>
                            <div class="trainer-maindata">
                                <ng-container *ngIf="dashboardItemData.assessorDetails != undefined && dashboardItemData.assessorDetails.length > 0">
                                    <ng-container *ngIf="dashboardItemData.assessorDetails[0].appointment_date != null && dashboardItemData.assessorDetails[0].appointment_date != ''">
                                        <span>{{dashboardItemData.assessorDetails[0].appointment_date | date:'y'}}</span>
                                    </ng-container>
                                    <ng-container *ngIf="dashboardItemData.assessorDetails[0].appointment_date == null || dashboardItemData.assessorDetails[0].appointment_date != ''">
                                        NA
                                    </ng-container>                                    
                                </ng-container>
                                
                            </div>
                        </div>
                        <div class="trainer-data-det" [ngStyle]="{'width': '50%'}">
                            <div class="trainer-pro" [ngStyle]="{'padding-left':'8px'}">
                                <span>Years in Service</span>
                            </div>
                            <div class="trainer-maindata"  [ngStyle]="{'padding-left':'8px'}">
                                <span>{{totalYear}}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="dashboard-events">
            <div class="row m-0">
                <!-- <div class="col-md-6">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="tra_events">
                                <div class="trainer_head">
                                    <h4>Schedule (Planned Events)</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="event_timings">
                                <ul>
                                    <li><span class="date-dash">20/01/2020</span>At vero eos et accusamus et iusto odio
                                        dignissimos ducimus qui blanditiis.</li>
                                    <hr>
                                    <li><span class="date-dash">19/01/2020</span>Et harum quidem rerum facilis est et
                                        expedita distinctio. Nam libero tempor.</li>
                                    <hr>
                                    <li><span class="date-dash">18/01/2020</span>Temporibus autem quibusdam et aut
                                        officiis debitis aut rerum necessity.</li>
                                    <hr>
                                    <li><span class="date-dash">17/01/2020</span>Aut reiciendis voluptatibus maiores
                                        alias consequatur aut perferendis.</li>
                                    <hr>
                                    <li><span class="date-dash">16/01/2020</span>Et harum quidem rerum facilis est et
                                        expedita distinctio.</li>
                                    <hr>
                                    <li><span class="date-dash">15/01/2020</span>Temporibus autem quibusdam et aut
                                        officiis debitis aut rerum.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div> -->
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="tra_events">
                                <div class="trainer_head">
                                    <h4>Recent Updates</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="event_timings">

                                <div class="date-cnt">
                                    <span>Last Activity</span>
                                </div>
                                <div class="activity-details">
                                    <ul>
                                        <ng-container *ngFor="let item of dashboardRecentUpdates">
                                            <li>{{item.title}}<span> on {{item.date | date: 'dd/MM/y, h:mm:ss a'}}</span></li>
                                        </ng-container>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Calendara -->
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="tra_events">
                                <div class="trainer_head">
                                    <h4>Calendar</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12"> 
                            <!-- Only Jquery fullcalendar -->
                            <!-- <div id="calendar"></div> -->
                            <!-- Output function...
                            (dateClick)="dateClick($event)"
                                      (clickButton)="clickButton($event)"
                                      (eventDragStop)="eventDragStop($event)"
                                      [eventsModel]="eventsModel"
                                      (eventClick)="eventClick($event)"
                            -->
                            <!-- ng-fullcalendar example -->
                            <!-- <div class="event-datetime">
                                <ng-container *ngIf="options">
                                    <ng-fullcalendar
                                      #fullcalendar                                 
                                      [options]="options"                                      
                                    ></ng-fullcalendar>
                                  </ng-container>
                            </div> -->
                            <div class="event-datetime">
                                <!-- <div id="calendar"></div>  -->
                                <ng-container *ngIf="options">
                                    <ng-fullcalendar #fullcalendar [options]="options" (eventClick)="fullcanderClick($event)"></ng-fullcalendar>
                                </ng-container>
                            </div>
                            
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="event_data">
            <div class="row m-0">
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="tra_events">
                                <div class="trainer_head">
                                    <h4>Events</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="ass-name-det">
                        <div class="row">
                            <div class="col-md-12">
                                <ng-container *ngIf="dashboardEvents.length > 0">
                                    <mat-accordion>
                                        <mat-expansion-panel (opened)="panelOpenState = true"
                                        (closed)="panelOpenState = false" *ngFor="let item of dashboardEvents;let i=index;" [expanded]="item.id == eventId ? true : false">
                                            <!-- <ng-container *ngFor="let item of dashboardEvents;"> -->
                                                <mat-expansion-panel-header >
                                                    <div class="ass-details" [ngStyle]="{'padding-bottom': '4px'}">
                                                        
                                                        <div class="date_content">
                                                            <span class="date-dash">
                                                                <span>
                                                                    {{item.event_start_date_time | date}}
                                                                </span>
                                                            </span>
                                                            {{item.courseDetails.course}}
                                                        </div>
                                                    </div>
                                                </mat-expansion-panel-header>

                                            <div class="ass-details">
                                                
                                                <div class="row ticket-cnt">
                                                    <div class="col-md-12">
                                                        <div class="status-wrapper-ticket" *ngIf="item.courseDetails != undefined">
                                                            <h3 [ngStyle]="{'font-size': '25px'}">{{item.courseDetails.course}}</h3>
                                                            <p [innerHTML]="item.courseDetails.course_description"></p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                                <div class="row ticket-details m-0">
                                                    <div class="col">
                                                            <div class="doc-data border-right-dash">
                                                                <div class="documents">
                                                                    <h5>Date</h5>
                                                                </div>
                                                                <div class="counts">
                                                                    <span>
                                                                        {{item.event_start_date_time | date}}
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col pl-0">
                                                            <div class="doc-data border-right-dash">
                                                                <div class="documents">
                                                                    <h5>Location</h5>
                                                                </div>
                                                                <div class="counts">
                                                                    <span *ngIf="item.courseDetails.location == 'eiac_training_center'">Eiac Training Center</span>
                                                                    <span *ngIf="item.courseDetails.location == 'client_premisis'">Client Premise</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col pl-0">
                                                            <div class="doc-data border-right-dash">
                                                                <div class="documents">
                                                                    <h5>Tutor</h5>
                                                                </div>
                                                                <div class="counts">
                                                                    <span *ngIf="item.tutor != undefined && item.tutor.name != ''">{{item.tutor.name}}</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col pl-0">
                                                            <div class="doc-data border-right-dash">
                                                                <div class="documents">
                                                                    <h5>Persons</h5>
                                                                </div>
                                                                <div class="counts">
                                                                    <span *ngIf="item.courseDetails.allTargatedAud != undefined">{{item.courseDetails.allTargatedAud.length}}</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col pl-0">
                                                            <div class="doc-data">
                                                                <div class="documents">
                                                                    <h5>Status</h5>
                                                                </div>
                                                                <div class="counts">
                                                                    <span *ngIf="item.courseDetails.status != undefined && item.courseDetails.status == true">Active</span>
                                                                    <span *ngIf="item.courseDetails.status != undefined && item.courseDetails.status == false">InActive</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                </div>
                                            <!-- </ng-container> -->
                                        </mat-expansion-panel>
                                    </mat-accordion>
                                </ng-container>
                                <ng-container *ngIf="dashboardEvents.length == 0">
                                    <p>No Events</p>
                                </ng-container>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- <div class="event_data">
            <div class="row m-0">
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="tra_events">
                                <div class="trainer_head">
                                    <h4>Events</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="ass-name-det">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="ass-details">
                                    <div class="date_content">
                                        <span class="date-dash">20/01/2020</span>
                                    </div>
                                    <div class="row ticket-cnt">
                                        <div class="col-md-12">
                                            <div class="status-wrapper-ticket">
                                                <h3>How do I tell you about a correction you need to make to an article?
                                                </h3>
                                                <p>Lorem ipsum dolor sit amet consectetur adipiscing elit sed do eiusmod
                                                    tempor incididunt
                                                    ut labore et dolore magna aliqua. Ut enim ad minim veniam quis
                                                    nostrud exercitation ullamco
                                                    laboris nisi ut aliquip ex ea commodo consequat.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row ticket-details m-0">
                                    <div class="col">
                                        <div class="doc-data border-right-dash">
                                            <div class="documents">
                                                <h5>Time</h5>
                                            </div>
                                            <div class="counts">
                                                <span>11:00 AM - 2:00 PM</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col pl-0">
                                        <div class="doc-data border-right-dash">
                                            <div class="documents">
                                                <h5>Location</h5>
                                            </div>
                                            <div class="counts">
                                                <span>Kolkata, India</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col pl-0">
                                        <div class="doc-data border-right-dash">
                                            <div class="documents">
                                                <h5>Topic</h5>
                                            </div>
                                            <div class="counts">
                                                <span>Kick Off Meeting</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col pl-0">
                                        <div class="doc-data border-right-dash">
                                            <div class="documents">
                                                <h5>Persons</h5>
                                            </div>
                                            <div class="counts">
                                                <span>10</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col pl-0">
                                        <div class="doc-data">
                                            <div class="documents">
                                                <h5>Status</h5>
                                            </div>
                                            <div class="counts">
                                                <span>Pending</span>
                                            </div>
                                        </div>
                                    </div>
                                   
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> -->
        <div class="comments-section">
            <div class="row m-0">
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="tra_events">
                                <div class="trainer_head">
                                    <h4>COMMUNICATION</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                    <p *ngIf="recordsTotal==0">No message</p>
                    <div class="ass-name-det" *ngFor="let row of messageList | paginate: config; let i = index;">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="ass-data">
                                    <h3>{{row.title}}</h3>
                                    <div class="date_wrapper">
                                        <p>{{row.created | date}}</p>
                                        <div class="reply_msg" (click)="getUserDetails(row.user)"
                                            *ngIf="row.meta_title != 'user_registration'"
                                            routerLink="/dashboard/message-reply/{{row.id}}">
                                            <span class="icon-chat"></span>
                                            Reply
                                        </div>
                                    </div>
                                </div>
                                <hr>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="assess-doc">
                                    <div class="data-attach">
                                        <h5>{{row.message}}</h5>
                                    </div>
                                </div>

                                <div class="ass-details" *ngIf="row.meta_title != 'user_registration'">
                                    <!-- <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
                                        eiusmod tempor incididunt
                                        ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis
                                        nostrud exercitation ullamco
                                        laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure
                                        dolor in reprehenderit in
                                        voluptate velit esse cillum dolore eu fugiat nulla pariatur.
                                        Excepteur sint occaecat cupidatat non
                                        proident, sunt in culpa qui officia deserunt mollit anim id est
                                        laborum. </p> -->
                                    <div class="attach-cnt" *ngIf="row.document!=null">
                                        <a href="{{constant.mediaPath+row.document}}" target="_blank"
                                            class="attachment-cnt"><span class="icon-attach"></span></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <pagination-controls (pageChange)="pageChanged($event)"></pagination-controls>

                    <div class="row">
                        <div class="col-md-12">
                            <div class="cmnt-content">
                                <form #ngForm="ngForm" (ngSubmit)="onSubmit(ngForm)">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <mat-form-field class="cab-data">
                                                <mat-label>Select</mat-label>
                                                <mat-select required [(ngModel)]="selectedField"
                                                    [ngModelOptions]="{standalone: true}"
                                                    (ngModelChange)="setField($event)">
                                                    <mat-option *ngFor="let data of select_field" [value]="data.value">
                                                        {{data.field}}</mat-option>
                                                </mat-select>
                                                <mat-error></mat-error>
                                            </mat-form-field>
                                        </div>

                                        <div class="col-md-6"
                                            *ngIf="getUserType=='cab_client' || getUserType=='cab_code'">
                                            <mat-form-field class="cab-data">                                               
                                                <mat-chip-list #chipList>
                                                    <mat-chip *ngFor="let option of selectedUser"
                                                        [selectable]="selectable" [removable]="removable"
                                                        (removed)="remove(option)">
                                                        {{option}}
                                                        <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
                                                    </mat-chip>
                                                    <input placeholder="{{selectedField}}" #fruitInput
                                                        [matAutocomplete]="auto" [matChipInputFor]="chipList"
                                                        [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                                                        (matChipInputTokenEnd)="add($event)"
                                                        (input)="search($event.target.value)">
                                                </mat-chip-list>
                                                <mat-autocomplete #auto="matAutocomplete">
                                                    <mat-option (onSelectionChange)="getValue(option, 'username')"
                                                        *ngFor="let option of selectSearch" [value]="option.username">
                                                        {{option.username}}
                                                    </mat-option>
                                                </mat-autocomplete>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-6"
                                            *ngIf="getUserType=='trainers' || getUserType=='operations'">
                                            <mat-form-field class="cab-data" #matForm>
                                                <mat-chip-list #chipList>
                                                    <mat-chip *ngFor="let option of selectedUser"
                                                        [selectable]="selectable" [removable]="removable"
                                                        (removed)="remove(option)">
                                                        {{option}}
                                                        <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
                                                    </mat-chip>
                                                    <input placeholder="{{selectedField}}" #fruitInput
                                                        [matAutocomplete]="auto" [matChipInputFor]="chipList"
                                                        [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                                                        (matChipInputTokenEnd)="add($event)"
                                                        (input)="search($event.target.value)">
                                                </mat-chip-list>
                                                <mat-autocomplete #auto="matAutocomplete">
                                                    <mat-option (onSelectionChange)="getValue(option, 'email')"
                                                        *ngFor="let option of selectSearch" [value]="option.email">
                                                        {{option.email}}
                                                    </mat-option>
                                                </mat-autocomplete>
                                            </mat-form-field>
                                        </div>

                                        <div class="col-md-3">
                                            <div class="matupload position-relative">
                                                <mat-form-field class="lng-data">
                                                    <input readonly name="upload_message" [(ngModel)]="documentName"
                                                        matInput name="file" placeholder="Upload Document">
                                                </mat-form-field>
                                                <span class="fileupload">
                                                    <input #file type="file" accept="application/pdf"
                                                        name="upload_message_file"
                                                        [(ngModel)]="chatMessage.upload_message_file"
                                                        (change)="validateFile($event)">
                                                    <span class="icon-attach attach-data" (click)="file.click()"></span>
                                                </span>
                                                <p class="error" *ngIf="!file_validation">Please Upload a
                                                    valid file (ex: pdf)</p>
                                            </div>
                                        </div>
                                        <div class="col-md-12">
                                            <mat-form-field class="cab-data">
                                                <mat-label>Message</mat-label>
                                                <input name="message" maxlength="200" required
                                                    [(ngModel)]="chatMessage.message" matInput autocomplete="off"
                                                    placeholder="Message">
                                                <mat-error></mat-error>
                                            </mat-form-field>
                                        </div>

                                    </div>
                                    <div class="row mt-4">
                                        <div class="col-md-12">
                                            <div class="bttns-appln mb-0">
                                                <button class="submit-bttn" [disabled]="button_disable">SEND
                                                    MESSAGE</button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <!-- <div class="hdr-sec">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="trainer_head">
                                    <h4>WRITE A COMMENT</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="cmnt-content">
                                <div class="row">
                                    <div class="col-md-8">
                                        <mat-form-field class="cab-data">
                                            <mat-label>Message</mat-label>
                                            <input  matInput autocomplete="off" placeholder="Message">
                                            <mat-error></mat-error>      
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="matupload position-relative">
                                            <mat-form-field  class="lng-data">
                                                <input matInput name="trade_license_name" placeholder="Upload Document" >
                                            </mat-form-field>
                                            <span class="fileupload">
                                                <input type="file" required>
                                                <span class="icon-attach attach-data"></span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mt-4">
                                    <div class="col-md-12">
                                        <div class="bttns-appln mb-0">
                                            <button class="submit-bttn">SEND MESSAGE</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> -->
                </div>
            </div>
        </div>
    </div>
</div>